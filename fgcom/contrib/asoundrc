# http://blog.gmane.org/gmane.comp.telephony.pbx.asterisk.iaxclient.devel/month=20090101

pcm.dmixer {
     type dmix
     ipc_key 1024
     ipc_perm 0666       # Andere Benutzer können ebenfalls dmix gleichzeitig nutzen
     slave.pcm "snd_card"
     slave {
         pcm "hw:0,0"
         # buffer_size kann bei Problemen der jeweiligen Karte angepasst werden.
         period_time 0
         period_size 128
         buffer_size 8192
         # bei Störungen kann die Konvertierung auf die Rate 44100 eingeschaltet werden.
         rate 44100
         # einige Soundkarten benötigen das exakte Datenformat (zB ice1712)
         # format S32_LE
      }
      bindings {
         0 0
         1 1
      }
}

# Das dsnoop-Plugin, welches es erlaubt, mehrere Programme gleichzeitig aufnehmen zu lassen.
pcm.dsnooper {
     type dsnoop
     ipc_key 2048
     ipc_perm 0666
     slave.pcm "snd_card"
     slave
     {
         pcm "hw:0,0"
         period_time 0
         period_size 128
         buffer_size 8192
         # bei Störungen kann die Konvertierung auf die Rate 44100 eingeschaltet werden.
         rate 44100
         # einige Soundkarten benötigen das exakte Datenformat (zB ice1712)
         # format S32_LE
         format S16_LE
     }
     bindings {
         0 0
         1 1
     }
}

# Dies definiert unser Fullduplex-Plugin als Standard für alle ALSA-Programme.
pcm.duplex {
    type asym
    playback.pcm "dmixer"
    capture.pcm "dsnooper"
    hint {
        show on
        description "My Alsa DMIX Soundcard "
    }
}

pcm.!default {
    type plug 
    slave.pcm "duplex"
}
